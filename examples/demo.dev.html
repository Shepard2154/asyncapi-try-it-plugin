<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Try-it plugin demo</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/@asyncapi/react-component@3.0.2/styles/default.min.css"
    />
    <style>
      body {
        font-family: system-ui, sans-serif;
        margin: 1rem;
      }
      h1 {
        font-size: 1.25rem;
      }
    </style>
  </head>
  <body>
    <h1>Try-it plugin demo</h1>
    <div id="asyncapi"></div>

    <script src="https://unpkg.com/@asyncapi/react-component@3.0.2/browser/standalone/index.js"></script>
    <script src="../dist/index.iife.js"></script>

    <script>
      const schema = {
        asyncapi: '2.6.0',
        info: { title: 'Try-it payload demo', version: '1.1.0' },
        channels: {
          'users.created': {
            publish: {
              operationId: 'usersCreated',
              message: {
                payload: {
                  type: 'object',
                  required: ['userId', 'name'],
                  properties: {
                    userId: { type: 'string', example: 'u-123' },
                    name: { type: 'string', example: 'Alice' },
                    age: { type: 'integer', example: 30 },
                    active: { type: 'boolean', example: true },
                  },
                },
              },
            },
          },
          'tags.updated': {
            publish: {
              operationId: 'tagsUpdated',
              message: {
                payload: {
                  type: 'array',
                  items: { type: 'string' },
                },
              },
            },
          },
          'system.status': {
            publish: {
              operationId: 'systemStatus',
              message: {
                payload: {
                  type: 'string',
                  example: 'ok',
                },
              },
            },
          },
          'system.ping': {
            publish: {
              operationId: 'systemPing',
              message: {
                payload: {
                  type: 'null',
                },
              },
            },
          },
        },
      };

      // For demo POST goes to httpbin.org (static servers return 405 for local POST)
      const plugin = window.AsyncApiTryItPlugin.createTryItOutPlugin({
        endpointBase: 'asyncapi/try',
        showPayloadSchema: true,
        showEndpointInput: true,
        resolveEndpoint: () => 'https://httpbin.org/post',
      });

      window.AsyncApiStandalone.render(
        { schema, plugins: [plugin] },
        document.getElementById('asyncapi'),
      );
    </script>
  </body>
</html>
